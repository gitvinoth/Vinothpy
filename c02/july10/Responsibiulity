Rule engine responsibility -

Trigger the rule script as per the defined rule run frequency.

Fetch data for parameters defined in the rule for defined historical duration + current time range.

Support create_anomaly(anomalies, rule) function to pass the anomaly output generated by the rule script. This output needs to be passed to the alert processor service.

Rule script responsibility -

Support for __main(parameters_data, current_time_range, metadata) that will have the rule logic to run on raw sensor data and timestamp.

Run the rule only for data in current_time_range. Rest data will be used for historical aggregation calculations.

Call the create_anomaly(anomalies, rule) function with data as below -

array of anomalies with

start and end time

parameter data that needs to be visualized in alerts app. example, z-score, threshold etc along with axis labels etc.
