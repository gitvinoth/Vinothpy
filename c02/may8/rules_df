rule_id	rule_name	tenant_id	condition_id	condition_name	asset_id	join_condition	parameter	operator	class	threshold	duration	wire	function	wire_length_from	wire_length_to	rule_run_frequency	max_data_frequency	sensor_type	severity	risk_register_controls	baseline_time	threshold_unit	window_slide_duration	group_id	query	combined_query	last_updated_date	combined_query_updated_date
5834	Bend Magnitude of Test well 1 >0.7	c15e863f-cf2d-4006-b289-cf01f35a30ca	5500	Bend Magnitude of Test well 1 >0.7	["TW_001"]		bend_magnitude	>	null	0.7	null	wire 1	raw	0	2000	1	1	dss	high	[1]	null	null	null	null	select condition_1.timestamp as start_time from (select DISTINCT(`timestamp`) as `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001' and wire = 'wire 1' and depth between 0 and 2000 and bend_mag > 0.7 and cast(`timestamp` as bigint) between $start_time and $end_time) as condition_1 	null	2025-02-07T04:48:07.630+00:00	-
3	rule1	20976703-b49e-426f-a654-4632742c6589	101	Average of bend magnitude for wire-1 from 1000-1500 ft. is greater than 10%	["TW_001"]	and	bend_magnitude	>	null	10	null	1	average	1000	1500	1	1	dss	high	[5]	1708992000	%	null	null	select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 1 and depth between 1000 and 1500 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 10.0 ) as condition_1	null	2025-05-07T03:46:17.006+00:00	-
1	rule1	20976703-b49e-426f-a654-4632742c6589	1	Pressure is greater than 400 psi for 60 seconds	["TW_001"]	null	pressure	>	null	400	60	null	raw	null	null	1	1	ptgauge	high	[5]	null	psi	0	3	select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 400.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 60 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1) INTERSECT select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 400.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 60 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	2025-05-06T04:49:29.672+00:00	2025-05-07T06:18:00.917+00:00
1	rule1	20976703-b49e-426f-a654-4632742c6589	2	bend magnitude differential over 27th-Feb-2024 for wire-1 from 1000-2000 ft. is greater than 5%	["TW_001"]	null	bend_magnitude	>	null	5	null	1	differential	1000	2000	1	1	dss	high	[5]	null	%	0	3	WITH baseline_tw_001 AS (SELECT depth, timestamp, bend_mag AS baseline_value FROM `$catalog`.silver_zone.dss WHERE asset_id = 'TW_001' AND wire = 1 AND depth BETWEEN 1000 AND 2000 AND timestamp = 1708992000 ), current_tw_001 AS (SELECT depth, timestamp, bend_mag AS current_value FROM `$catalog`.silver_zone.dss WHERE asset_id = 'TW_001' AND wire = 1 AND depth BETWEEN 1000 AND 2000 AND timestamp BETWEEN $start_time AND $end_time ), differential_tw_001 AS (SELECT d.timestamp, d.depth, ((d.current_value - b.baseline_value) / b.baseline_value) * 100 AS value_difference FROM current_tw_001 d JOIN baseline_tw_001 b ON d.depth = b.depth ), cte_tw_001 AS (select min(timestamp) as start_time, max(timestamp) as end_time from ( select timestamp, diff, grp, max(grp) over (order by timestamp rows between unbounded preceding and current row) group_member from (select timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select timestamp, coalesce((timestamp - lag(timestamp) OVER (ORDER BY timestamp)), 1) as diff from ( SELECT d.timestamp FROM differential_tw_001 d WHERE d.value_difference > 5.0 ) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(timestamp) - min(timestamp) >= 0 or min(timestamp) = $start_time - 1 or max(timestamp) = $end_time) SELECT t1.start_time, t1.end_time FROM cte_tw_001 t1	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1) INTERSECT select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 400.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 60 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	2025-05-06T04:49:29.672+00:00	2025-05-07T06:18:00.917+00:00
1	Bend Magnitude of Test well 1 >0.7	c15e863f-cf2d-4006-b289-cf01f35a30ca	5502	Bend Magnitude of Test well 1 >0.7	["TW_001"]		bend_magnitude	>	null	0.7	null	wire 1	raw	0	2000	1	1	dss	high	[1]	null	null	null	3	select condition_1.timestamp as start_time from (select DISTINCT(`timestamp`) as `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001' and wire = 'wire 1' and depth between 0 and 2000 and bend_mag > 0.7 and cast(`timestamp` as bigint) between $start_time and $end_time) as condition_1 	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1) INTERSECT select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 400.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 60 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	2025-02-07T04:48:07.630+00:00	2025-05-07T06:18:00.917+00:00
1	Bend Magnitude Average > 0.3 for Test well-1	c15e863f-cf2d-4006-b289-cf01f35a30ca	5503	Bend Magnitude Average > 0.3 for Test well 1	["TW_001"]		bend_magnitude	>	null	0.3	null	wire 1	average	0	2000	1	1	dss	high	[4]	null	null	null	3	select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1) INTERSECT select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 400.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 60 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	2025-02-07T04:48:07.630+00:00	2025-05-07T06:18:00.917+00:00
2	rule1	20976703-b49e-426f-a654-4632742c6589	1	Pressure is greater than 200 psi for 40 seconds	["TW_001"]	and	pressure	>	null	200	40	null	raw	null	null	1	1	ptgauge	high	[5]	null	psi	0	1	select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 200.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 40 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 1 and depth between 1000 and 1500 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 10.0 ) as condition_1) INTERSECT select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 200.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 40 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	2025-05-07T03:40:13.249+00:00	2025-05-07T06:18:00.917+00:00
2	rule1	20976703-b49e-426f-a654-4632742c6589	2	Average of bend magnitude for wire-1 from 1000-1500 ft. is greater than 10%	["TW_001"]	and	bend_magnitude	>	null	10	null	1	average	1000	1500	1	1	dss	high	[5]	1708992000	%	null	1	select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 1 and depth between 1000 and 1500 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 10.0 ) as condition_1	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 1 and depth between 1000 and 1500 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 10.0 ) as condition_1) INTERSECT select min(epoch_timestamp) as start_time, max(epoch_timestamp) as end_time from ( select epoch_timestamp, diff, grp, max(grp) over (order by epoch_timestamp rows between unbounded preceding and current row) group_member from (select epoch_timestamp, diff, case when diff>1 then sum(diff) OVER (ORDER BY epoch_timestamp ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) end grp from (select epoch_timestamp, coalesce((epoch_timestamp - lag(epoch_timestamp) OVER (ORDER BY epoch_timestamp)), 1) as diff from (select condition_1.epoch_timestamp from (select epoch_timestamp, asset_id from `$catalog`.silver_zone.pt_gauge where pressure > 200.0 and asset_id = 'TW_001' and epoch_timestamp between $start_time - 1 and $end_time) condition_1) condition_group) timestamp_diffs) anomaly_group_step_1) anomaly_group group by group_member having max(epoch_timestamp) - min(epoch_timestamp) >= 40 or min(epoch_timestamp) = $start_time - 1 or max(epoch_timestamp) = $end_time	2025-05-07T03:40:13.249+00:00	2025-05-07T06:18:00.917+00:00
5835	Bend Magnitude of Test well 1 >0.7	c15e863f-cf2d-4006-b289-cf01f35a30ca	5501	Bend Magnitude of Test well 1 >0.7	["TW_001"]		bend_magnitude	>	null	0.7	null	wire 1	raw	0	2000	1	1	dss	high	[1]	null	null	null	2	select condition_1.timestamp as start_time from (select DISTINCT(`timestamp`) as `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001' and wire = 'wire 1' and depth between 0 and 2000 and bend_mag > 0.7 and cast(`timestamp` as bigint) between $start_time and $end_time) as condition_1 	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1)	2025-02-07T04:48:07.630+00:00	2025-05-07T06:18:00.917+00:00
5835	Bend Magnitude Average > 0.3 for Test well-1	c15e863f-cf2d-4006-b289-cf01f35a30ca	5502	Bend Magnitude Average > 0.3 for Test well 1	["TW_001"]		bend_magnitude	>	null	0.3	null	wire 1	average	0	2000	1	1	dss	high	[4]	null	null	null	2	select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1	SELECT start_time, '' AS end_time FROM (select condition_1.timestamp as start_time from (select `timestamp` from `$catalog`.silver_zone.dss where asset_id='TW_001'and wire = 'wire 1' and depth between 0 and 2000 and cast(`timestamp` as bigint) between $start_time and $end_time group by `timestamp` having avg(bend_mag) > 0.3 ) as condition_1)	2025-02-07T04:48:07.630+00:00	2025-05-07T06:18:00.917+00:00
