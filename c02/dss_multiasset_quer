"WITH (SELECT depth, timestamp, axial_strain AS baseline_value FROM `$catalog`.silver_zone.dss WHERE asset_id = 'DSS_001' AND wire = W2 AND depth BETWEEN 500 AND 1500 AND timestamp = 1714008000 ) baseline_dss_001, (SELECT depth, timestamp, axial_strain AS current_value FROM `$catalog`.silver_zone.dss WHERE asset_id = 'DSS_001' AND wire = W2 AND depth BETWEEN 500 AND 1500 AND timestamp BETWEEN $start_time AND $end_time ) current_dss_001, (SELECT d.timestamp, d.depth, ((d.current_value - b.baseline_value) / b.baseline_value) * 100 AS value_difference FROM current_dss_001 d JOIN baseline_dss_001 b ON d.depth = b.depth) differential_dss_001, (SELECT depth, timestamp, axial_strain AS baseline_value FROM `$catalog`.silver_zone.dss WHERE asset_id = 'DSS_002' AND wire = W2 AND depth BETWEEN 500 AND 1500 AND timestamp = 1714008000 ) baseline_dss_002, (SELECT depth, timestamp, axial_strain AS current_value FROM `$catalog`.silver_zone.dss WHERE asset_id = 'DSS_002' AND wire = W2 AND depth BETWEEN 500 AND 1500 AND timestamp BETWEEN $start_time AND $end_time ) current_dss_002, (SELECT d.timestamp, d.depth, ((d.current_value - b.baseline_value) / b.baseline_value) * 100 AS value_difference FROM current_dss_002 d JOIN baseline_dss_002 b ON d.depth = b.depth) differential_dss_002 SELECT DISTINCT timestamp AS start_time FROM differential_dss_001 WHERE value_difference >= 10.0 UNION ALL SELECT DISTINCT timestamp AS start_time FROM differential_dss_002 WHERE value_difference >= 10.0"
