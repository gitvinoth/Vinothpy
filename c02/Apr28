
handle_pressure_temperature(
   asset_id_list=["PTG_001","PTG_003"],
   data_frequency_list=[60,60],
   function="average",
   duration=10,
   join_condition="and",
   parameter="pressure",
   operator=">",
   threshold=50.0
)


"WITH base_ptgauge_$asset_index AS (SELECT epoch_timestamp, pressure  FROM `$catalog`.silver_zone.pt_gauge WHERE asset_id = 'PTG_001' AND epoch_timestamp BETWEEN $start_time AND $end_time) SELECT a.epoch_timestamp AS timestamp FROM base_ptgauge_$asset_index a JOIN base_ptgauge_$asset_index b  ON b.epoch_timestamp BETWEEN a.epoch_timestamp AND a.epoch_timestamp + (10 - 1) GROUP BY a.epoch_timestamp HAVING AVG(b.pressure) > 50.0 inner join WITH base_ptgauge_$asset_index AS (SELECT epoch_timestamp, pressure  FROM `$catalog`.silver_zone.pt_gauge WHERE asset_id = 'PTG_003' AND epoch_timestamp BETWEEN $start_time AND $end_time) SELECT a.epoch_timestamp AS timestamp FROM base_ptgauge_$asset_index a JOIN base_ptgauge_$asset_index b  ON b.epoch_timestamp BETWEEN a.epoch_timestamp AND a.epoch_timestamp + (10 - 1) GROUP BY a.epoch_timestamp HAVING AVG(b.pressure) > 50.0 on condition_1.timestamp = condition_2.timestamp"
