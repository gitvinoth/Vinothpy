generate_differential_query(
   table_name="pt_gauge",
   baseline_template=PT_BASELINE_TEMPLATE,
   current_template=PT_CURRENT_TEMPLATE,
   differential_template=PT_DIFFERENTIAL_TEMPLATE,
   parameter="pressure",
   timestamp_column="epoch_timestamp",
   asset_id_list=["PTG_001","PTG_002"],
   operator=">",
   threshold=50.0,
   join_condition="and",
   baseline_timestamp=1714008000,
   duration = 10
)
"WITH (SELECT epoch_timestamp, asset_id, pressure AS baseline_value FROM `$catalog`.silver_zone.pt_gauge WHERE asset_id = 'PTG_001' AND epoch_timestamp = 1714008000) baseline_ptg_001 , (SELECT epoch_timestamp, asset_id, pressure AS current_value FROM `$catalog`.silver_zone.pt_gauge WHERE asset_id = 'PTG_001' AND epoch_timestamp BETWEEN $start_time AND $end_time) current_ptg_001, (SELECT d.epoch_timestamp,ABS((d.current_value - b.baseline_value) / b.baseline_value) * 100 AS value_difference FROM current_ptg_001 d JOIN baseline_ptg_001 b ON d.asset_id = b.asset_id) differential_ptg_001, (SELECT epoch_timestamp, asset_id, pressure AS baseline_value FROM `$catalog`.silver_zone.pt_gauge WHERE asset_id = 'PTG_002' AND epoch_timestamp = 1714008000) baseline_ptg_002 , (SELECT epoch_timestamp, asset_id, pressure AS current_value FROM `$catalog`.silver_zone.pt_gauge WHERE asset_id = 'PTG_002' AND epoch_timestamp BETWEEN $start_time AND $end_time) current_ptg_002, (SELECT d.epoch_timestamp,ABS((d.current_value - b.baseline_value) / b.baseline_value) * 100 AS value_difference FROM current_ptg_002 d JOIN baseline_ptg_002 b ON d.asset_id = b.asset_id) differential_ptg_002, final_anomalies AS (SELECT t1.start_time,t1.end_time FROM (SELECT d.timestamp AS start_time,d.timestamp + (10 - 1) AS end_time FROM differential_ptg_001 d WHERE d.value_difference > 50.0) t1 INNER JOIN (SELECT d.timestamp AS start_time,d.timestamp + (10 - 1) AS end_time FROM differential_ptg_002 d WHERE d.value_difference > 50.0) t2 ON t1.start_time <= t2.end_time AND t2.start_time <= t1.end_time) SELECT DISTINCT start_time,end_time FROM final_anomalies"
